Third file written by Yiming Luo